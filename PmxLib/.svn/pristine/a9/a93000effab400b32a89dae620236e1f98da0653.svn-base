
#ifndef __FbxHelper_h__
#define __FbxHelper_h__

#include <fbxsdk.h>
#include "MathVector.h"

class FbxHelper
{
public:
	class Shape
	{
		friend class FbxHelper;
	public:
		Shape(FbxHelper * owner, const char * strName);

		void InitPositionSize(int count);
		void SetPositionAt(const Vector3 & pos, int idx);
		void AddNormal(const Vector3 & normal);
		void AddUV(const Vector2 & uv);

		void BeginFace(int matID);
		void AddIndex(int vertID);
		void EndFace();

		void AddMaterial(FbxSurfaceMaterial * pMaterial);

	private:
		FbxHelper					*m_pOwner;
		FbxNode						*m_pNode;
		FbxMesh						*m_pMesh;
		FbxGeometryElementNormal	*m_pNormalElement;
		FbxGeometryElementUV		*m_pUVElement;

		FbxGeometryElementMaterial	*m_pMaterialElement;
	};

public:
	FbxHelper();
	~FbxHelper();
	
	void SetInfo();
	bool SaveScene(const char * pFileName, bool pEmbedMedia = false, int pFileFormat = -1);

	Shape * BeginShape(const char * strName);
	void EndShape(Shape * pShape);

	FbxSurfacePhong * NewPhong(const char * strMatName);
	FbxFileTexture * NewTexture(const char * strName, const char * strFileName);

private:
	FbxManager	*m_pSdkMgr;
	FbxScene	*m_pScene;
};

#endif